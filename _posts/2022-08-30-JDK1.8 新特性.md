---
title:  JDK1.8 æ–°ç‰¹æ€§
date: 2022-08-29 10:34:00 +0800
categories: [JAVAå­¦ä¹ æ€»ç»“]
tags: [å­¦ä¹ æ€»ç»“]
pin: true
author: æ¨åœ£åƒ§

toc: true
comments: true
typora-root-url: ../../ysh8023.github.io
math: false
mermaid: true
---

![yiqunmeinv](/assets/blog_res/yiqunmeinv.jpg)

# JDK1.8 æ–°ç‰¹æ€§

æœ¬æ–‡ä¸»è¦ä»‹ç»äº†JDK1.8ç‰ˆæœ¬ä¸­çš„ä¸€äº›æ–°ç‰¹æ€§ï¼Œä¹ƒä½œè€…è§†é¢‘è§‚åç¬”è®°ï¼Œä»…ä¾›å‚è€ƒã€‚

jdk1.8æ–°ç‰¹æ€§çŸ¥è¯†ç‚¹ï¼š

- **Lambdaè¡¨è¾¾å¼**
- **å‡½æ•°å¼æ¥å£**
- ***æ–¹æ³•å¼•ç”¨å’Œæ„é€ å™¨è°ƒç”¨**
- **Stream API**
- **æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•**
- **æ–°æ—¶é—´æ—¥æœŸAPI**

> åœ¨jdk1.8ä¸­å¯¹hashMapç­‰map[é›†åˆ](https://so.csdn.net/so/search?q=é›†åˆ&spm=1001.2101.3001.7020)çš„æ•°æ®ç»“æ„ä¼˜åŒ–ã€‚hashMapæ•°æ®ç»“æ„çš„ä¼˜åŒ–
> åŸæ¥çš„hashMapé‡‡ç”¨çš„[æ•°æ®ç»“æ„](https://so.csdn.net/so/search?q=æ•°æ®ç»“æ„&spm=1001.2101.3001.7020)æ˜¯å“ˆå¸Œè¡¨ï¼ˆæ•°ç»„+é“¾è¡¨ï¼‰ï¼ŒhashMapé»˜è®¤å¤§å°æ˜¯16ï¼Œä¸€ä¸ª0-15ç´¢å¼•çš„æ•°ç»„ï¼Œå¦‚ä½•å¾€é‡Œé¢å­˜å‚¨å…ƒç´ ï¼Œé¦–å…ˆè°ƒç”¨å…ƒç´ çš„hashcode
> æ–¹æ³•ï¼Œè®¡ç®—å‡ºå“ˆå¸Œç å€¼ï¼Œç»è¿‡å“ˆå¸Œç®—æ³•ç®—æˆæ•°ç»„çš„ç´¢å¼•å€¼ï¼Œå¦‚æœå¯¹åº”çš„ç´¢å¼•å¤„æ²¡æœ‰å…ƒç´ ï¼Œç›´æ¥å­˜æ”¾ï¼Œå¦‚æœæœ‰å¯¹è±¡åœ¨ï¼Œé‚£ä¹ˆæ¯”è¾ƒå®ƒä»¬çš„equalsæ–¹æ³•æ¯”è¾ƒå†…å®¹
> å¦‚æœå†…å®¹ä¸€æ ·ï¼Œåä¸€ä¸ªvalueä¼šå°†å‰ä¸€ä¸ªvalueçš„å€¼è¦†ç›–ï¼Œå¦‚æœä¸ä¸€æ ·ï¼Œåœ¨1.7çš„æ—¶å€™ï¼ŒååŠ çš„æ”¾åœ¨å‰é¢ï¼Œå½¢æˆä¸€ä¸ªé“¾è¡¨ï¼Œå½¢æˆäº†ç¢°æ’ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¦‚æœé“¾è¡¨
> æ— é™ä¸‹å»ï¼Œé‚£ä¹ˆæ•ˆç‡æä½ï¼Œç¢°æ’æ˜¯é¿å…ä¸äº†çš„
> åŠ è½½å› å­ï¼š0.75ï¼Œæ•°ç»„æ‰©å®¹ï¼Œè¾¾åˆ°æ€»å®¹é‡çš„75%ï¼Œå°±è¿›è¡Œæ‰©å®¹ï¼Œä½†æ˜¯æ— æ³•é¿å…ç¢°æ’çš„æƒ…å†µå‘ç”Ÿ
> åœ¨1.8ä¹‹åï¼Œåœ¨æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘æ¥å®ç°hashmapï¼Œå½“ç¢°æ’çš„å…ƒç´ ä¸ªæ•°å¤§äº8æ—¶ & æ€»å®¹é‡å¤§äº64ï¼Œä¼šæœ‰çº¢é»‘æ ‘çš„å¼•å…¥
> é™¤äº†æ·»åŠ ä¹‹åï¼Œæ•ˆç‡éƒ½æ¯”é“¾è¡¨é«˜ï¼Œ1.8ä¹‹åé“¾è¡¨æ–°è¿›å…ƒç´ åŠ åˆ°æœ«å°¾
> ConcurrentHashMap (é”åˆ†æ®µæœºåˆ¶)ï¼ŒconcurrentLevel,jdk1.8é‡‡ç”¨CASç®—æ³•(æ— é”ç®—æ³•ï¼Œä¸å†ä½¿ç”¨é”åˆ†æ®µ)ï¼Œæ•°ç»„+é“¾è¡¨ä¸­ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘çš„ä½¿ç”¨

## [Lambda](https://so.csdn.net/so/search?q=Lambda&spm=1001.2101.3001.7020)è¡¨è¾¾å¼

> lambda[è¡¨è¾¾å¼](https://so.csdn.net/so/search?q=è¡¨è¾¾å¼&spm=1001.2101.3001.7020)æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µåŒ¿åå†…éƒ¨ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç 

å…ˆæ¥ä½“éªŒä¸€ä¸‹lambdaæœ€ç›´è§‚çš„ä¼˜ç‚¹ï¼šç®€æ´ä»£ç 

```java
  //åŒ¿åå†…éƒ¨ç±»
  Comparator<Integer> cpt = new Comparator<Integer>() {
      @Override
      public int compare(Integer o1, Integer o2) {
          return Integer.compare(o1,o2);
      }
  };

  TreeSet<Integer> set = new TreeSet<>(cpt);

  System.out.println("=========================");

  //ä½¿ç”¨lambdaè¡¨è¾¾å¼
  Comparator<Integer> cpt2 = (x,y) -> Integer.compare(x,y);
  TreeSet<Integer> set2 = new TreeSet<>(cpt2);
```

åªéœ€è¦ä¸€è¡Œä»£ç ï¼Œæå¤§å‡å°‘ä»£ç é‡ï¼ï¼

è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨å•†åŸæµè§ˆå•†å“ä¿¡æ¯æ—¶ï¼Œç»å¸¸ä¼šæœ‰æ¡ä»¶çš„è¿›è¡Œç­›é€‰æµè§ˆï¼Œä¾‹å¦‚è¦é€‰é¢œè‰²ä¸ºçº¢è‰²çš„ã€ä»·æ ¼å°äº8000åƒçš„â€¦.

```java
// ç­›é€‰é¢œè‰²ä¸ºçº¢è‰²
public  List<Product> filterProductByColor(List<Product> list){
    List<Product> prods = new ArrayList<>();
    for (Product product : list){
        if ("çº¢è‰²".equals(product.getColor())){
            prods.add(product);
        }
    }
    return prods;
 }

// ç­›é€‰ä»·æ ¼å°äº8åƒçš„
public  List<Product> filterProductByPrice(List<Product> list){
    List<Product> prods = new ArrayList<>();
    for (Product product : list){
        if (product.getPrice() < 8000){
            prods.add(product);
        }
    }
    return prods;
 }
```

æˆ‘ä»¬å‘ç°å®é™…ä¸Šè¿™äº›è¿‡æ»¤æ–¹æ³•çš„æ ¸å¿ƒå°±åªæœ‰ifè¯­å¥ä¸­çš„æ¡ä»¶åˆ¤æ–­ï¼Œå…¶ä»–å‡ä¸ºæ¨¡ç‰ˆä»£ç ï¼Œæ¯æ¬¡å˜æ›´ä¸€ä¸‹éœ€æ±‚ï¼Œéƒ½éœ€è¦æ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åå¤åˆ¶é»è´´ï¼Œå‡è®¾è¿™ä¸ªè¿‡æ»¤æ–¹æ³•æœ‰å‡ ç™¾è¡Œï¼Œé‚£ä¹ˆè¿™æ ·çš„åšæ³•éš¾å…ç¬¨æ‹™äº†ä¸€ç‚¹ã€‚å¦‚ä½•è¿›è¡Œä¼˜åŒ–å‘¢ï¼Ÿ

ä¼˜åŒ–ä¸€ï¼šä½¿ç”¨è®¾è®¡æ¨¡å¼

å®šä¹‰ä¸€ä¸ªMyPredicateæ¥å£

```java
public interface MyPredicate <T> {
    boolean test(T t);
}
```

å¦‚æœæƒ³è¦ç­›é€‰é¢œè‰²ä¸ºçº¢è‰²çš„å•†å“ï¼Œå®šä¹‰ä¸€ä¸ªé¢œè‰²è¿‡æ»¤ç±»

```java
public class ColorPredicate implements MyPredicate <Product> {

     private static final String RED = "çº¢è‰²";

     @Override
     public boolean test(Product product) {
         return RED.equals(product.getColor());
     }
```

å®šä¹‰è¿‡æ»¤æ–¹æ³•ï¼Œå°†è¿‡æ»¤æ¥å£å½“åšå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·è¿™ä¸ªè¿‡æ»¤æ–¹æ³•å°±ä¸ç”¨ä¿®æ”¹ï¼Œåœ¨å®é™…è°ƒç”¨çš„æ—¶å€™å°†å…·ä½“çš„å®ç°ç±»ä¼ å…¥å³å¯ã€‚

```java
public List<Product> filterProductByPredicate(List<Product> list,MyPredicate<Product> mp){
        List<Product> prods = new ArrayList<>();
        for (Product prod : list){
            if (mp.test(prod)){
                prods.add(prod);
            }
        }
        return prods;
    }
```

ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è¦ç­›é€‰ä»·æ ¼å°äº8000çš„å•†å“ï¼Œé‚£ä¹ˆæ–°å»ºä¸€ä¸ªä»·æ ¼è¿‡æ»¤ç±»æ—¢å¯

```java
public class PricePredicate implements MyPredicate<Product> {
    @Override
    public boolean test(Product product) {
        return product.getPrice() < 8000;
    }
}
```

è¿™æ ·å®ç°çš„è¯å¯èƒ½æœ‰äººä¼šè¯´ï¼Œæ¯æ¬¡å˜æ›´éœ€æ±‚éƒ½éœ€è¦æ–°å»ºä¸€ä¸ªå®ç°ç±»ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹ç¹çå‘€ï¼Œé‚£ä¹ˆå†æ¥ä¼˜åŒ–ä¸€ä¸‹

ä¼˜åŒ–äºŒï¼šä½¿ç”¨åŒ¿åå†…éƒ¨ç±»

å®šä¹‰è¿‡æ»¤æ–¹æ³•ï¼š

```java
public List<Product> filterProductByPredicate(List<Product> list,MyPredicate<Product> mp){
        List<Product> prods = new ArrayList<>();
        for (Product prod : list){
            if (mp.test(prod)){
                prods.add(prod);
            }
        }
        return prods;
    }
```

è°ƒç”¨è¿‡æ»¤æ–¹æ³•çš„æ—¶å€™ï¼š

```java
// æŒ‰ä»·æ ¼è¿‡æ»¤
public void test2(){
    filterProductByPredicate(proList, new MyPredicate<Product>() {
        @Override
        public boolean test(Product product) {
            return product.getPrice() < 8000;
        }
    });
}

 // æŒ‰é¢œè‰²è¿‡æ»¤
 public void test3(){
     filterProductByPredicate(proList, new MyPredicate<Product>() {
         @Override
         public boolean test(Product product) {
             return "çº¢è‰²".equals(product.getColor());
         }
     });
 }
```

ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ï¼Œå°±ä¸éœ€è¦æ¯æ¬¡éƒ½æ–°å»ºä¸€ä¸ªå®ç°ç±»ï¼Œç›´æ¥åœ¨æ–¹æ³•å†…éƒ¨å®ç°ã€‚çœ‹åˆ°åŒ¿åå†…éƒ¨ç±»ï¼Œä¸ç¦æƒ³èµ·äº†Lambdaè¡¨è¾¾å¼ã€‚

ä¼˜åŒ–ä¸‰ï¼šä½¿ç”¨lambdaè¡¨è¾¾å¼

å®šä¹‰è¿‡æ»¤æ–¹æ³•ï¼š

```java
public List<Product> filterProductByPredicate(List<Product> list,MyPredicate<Product> mp){
        List<Product> prods = new ArrayList<>();
        for (Product prod : list){
            if (mp.test(prod)){
                prods.add(prod);
            }
        }
        return prods;
    }
```

ä½¿ç”¨lambdaè¡¨è¾¾å¼è¿›è¡Œè¿‡æ»¤

```java
@Test
public void test4(){
      List<Product> products = filterProductByPredicate(proList, (p) -> p.getPrice() < 8000);
      for (Product pro : products){
          System.out.println(pro);
      }
  }
```

åœ¨jdk1.8ä¸­è¿˜æœ‰æ›´åŠ ç®€ä¾¿çš„æ“ä½œ [Stream](https://so.csdn.net/so/search?q=Stream&spm=1001.2101.3001.7020) API

ä¼˜åŒ–å››ï¼šä½¿ç”¨Stream API

ç”šè‡³ä¸ç”¨å®šä¹‰è¿‡æ»¤æ–¹æ³•ï¼Œç›´æ¥åœ¨é›†åˆä¸Šè¿›è¡Œæ“ä½œ

```java
// ä½¿ç”¨jdk1.8ä¸­çš„Stream APIè¿›è¡Œé›†åˆçš„æ“ä½œ
@Test
public void test(){
    // æ ¹æ®ä»·æ ¼è¿‡æ»¤
    proList.stream()
           .fliter((p) -> p.getPrice() <8000)
           .limit(2)
           .forEach(System.out::println);

    // æ ¹æ®é¢œè‰²è¿‡æ»¤
    proList.stream()
           .fliter((p) -> "çº¢è‰²".equals(p.getColor()))
           .forEach(System.out::println);

    // éå†è¾“å‡ºå•†å“åç§°
    proList.stream()
           .map(Product::getName)
           .forEach(System.out::println);
}
```

Lmabdaè¡¨è¾¾å¼çš„è¯­æ³•æ€»ç»“ï¼š () -> ();

| å‰ç½®                                       | è¯­æ³•                                                 |
| ------------------------------------------ | ---------------------------------------------------- |
| æ— å‚æ•°æ— è¿”å›å€¼                             | () -> System.out.println(â€œHello WOrldâ€)              |
| æœ‰ä¸€ä¸ªå‚æ•°æ— è¿”å›å€¼                         | (x) -> System.out.println(x)                         |
| æœ‰ä¸”åªæœ‰ä¸€ä¸ªå‚æ•°æ— è¿”å›å€¼                   | x -> System.out.println(x)                           |
| æœ‰å¤šä¸ªå‚æ•°ï¼Œæœ‰è¿”å›å€¼ï¼Œæœ‰å¤šæ¡lambdaä½“è¯­å¥   | (xï¼Œy) -> {System.out.println(â€œxxxâ€);return xxxx;}ï¼› |
| æœ‰å¤šä¸ªå‚æ•°ï¼Œæœ‰è¿”å›å€¼ï¼Œåªæœ‰ä¸€æ¡lambdaä½“è¯­å¥ | (xï¼Œy) -> xxxx                                       |

å£è¯€ï¼šå·¦å³é‡ä¸€çœæ‹¬å·ï¼Œå·¦ä¾§æ¨æ–­ç±»å‹çœ

æ³¨ï¼šå½“ä¸€ä¸ªæ¥å£ä¸­å­˜åœ¨å¤šä¸ªæŠ½è±¡æ–¹æ³•æ—¶ï¼Œå¦‚æœä½¿ç”¨lambdaè¡¨è¾¾å¼ï¼Œå¹¶ä¸èƒ½æ™ºèƒ½åŒ¹é…å¯¹åº”çš„æŠ½è±¡æ–¹æ³•ï¼Œå› æ­¤å¼•å…¥äº†å‡½æ•°å¼æ¥å£çš„æ¦‚å¿µ

## [å‡½æ•°å¼æ¥å£](https://so.csdn.net/so/search?q=å‡½æ•°å¼æ¥å£&spm=1001.2101.3001.7020)

> å‡½æ•°å¼æ¥å£çš„æå‡ºæ˜¯ä¸ºäº†ç»™Lambdaè¡¨è¾¾å¼çš„ä½¿ç”¨æä¾›æ›´å¥½çš„æ”¯æŒã€‚

ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ï¼Ÿ
ç®€å•æ¥è¯´å°±æ˜¯åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼ˆObjectç±»çš„publicæ–¹æ³•é™¤å¤–ï¼‰ï¼Œå°±æ˜¯å‡½æ•°å¼æ¥å£ï¼Œå¹¶ä¸”è¿˜æä¾›äº†æ³¨è§£ï¼š@FunctionalInterface

å¸¸è§çš„å››å¤§å‡½æ•°å¼æ¥å£

- Consumer ã€ŠTã€‹ï¼šæ¶ˆè´¹å‹æ¥å£ï¼Œæœ‰å‚æ— è¿”å›å€¼

```java
    @Test
    public void test(){
        changeStr("hello",(str) -> System.out.println(str));
    }

    /**
     *  Consumer<T> æ¶ˆè´¹å‹æ¥å£
     * @param str
     * @param con
     */
    public void changeStr(String str, Consumer<String> con){
        con.accept(str);
    }
```

- Supplier ã€ŠTã€‹ï¼šä¾›ç»™å‹æ¥å£ï¼Œæ— å‚æœ‰è¿”å›å€¼

```java
    @Test
    public void test2(){
        String value = getValue(() -> "hello");
        System.out.println(value);
    }

    /**
     *  Supplier<T> ä¾›ç»™å‹æ¥å£
     * @param sup
     * @return
     */
    public String getValue(Supplier<String> sup){
        return sup.get();
    }
```

- Function ã€ŠT,Rã€‹ï¼š:å‡½æ•°å¼æ¥å£ï¼Œæœ‰å‚æœ‰è¿”å›å€¼

```java
    @Test
    public void test3(){
        Long result = changeNum(100L, (x) -> x + 200L);
        System.out.println(result);
    }

    /**
     *  Function<T,R> å‡½æ•°å¼æ¥å£
     * @param num
     * @param fun
     * @return
     */
    public Long changeNum(Long num, Function<Long, Long> fun){
        return fun.apply(num);
    }
```

- Predicateã€ŠTã€‹ï¼š æ–­è¨€å‹æ¥å£ï¼Œæœ‰å‚æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼æ˜¯booleanç±»å‹

```java
public void test4(){
        boolean result = changeBoolean("hello", (str) -> str.length() > 5);
        System.out.println(result);
    }

    /**
     *  Predicate<T> æ–­è¨€å‹æ¥å£
     * @param str
     * @param pre
     * @return
     */
    public boolean changeBoolean(String str, Predicate<String> pre){
        return pre.test(str);
    }
```

åœ¨å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£åŸºç¡€ä¸Šï¼Œè¿˜æä¾›äº†è¯¸å¦‚BiFunctionã€BinaryOperationã€toIntFunctionç­‰æ‰©å±•çš„å‡½æ•°å¼æ¥å£ï¼Œéƒ½æ˜¯åœ¨è¿™å››ç§å‡½æ•°å¼æ¥å£ä¸Šæ‰©å±•è€Œæ¥çš„ï¼Œä¸åšèµ˜è¿°ã€‚

æ€»ç»“ï¼šå‡½æ•°å¼æ¥å£çš„æå‡ºæ˜¯ä¸ºäº†è®©æˆ‘ä»¬æ›´åŠ æ–¹ä¾¿çš„ä½¿ç”¨lambdaè¡¨è¾¾å¼ï¼Œä¸éœ€è¦è‡ªå·±å†æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œç›´æ¥æ‹¿æ¥ç”¨å°±å¥½äº†ï¼Œè´´

## æ–¹æ³•å¼•ç”¨

> è‹¥lambdaä½“ä¸­çš„å†…å®¹æœ‰æ–¹æ³•å·²ç»å®ç°äº†ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨â€œæ–¹æ³•å¼•ç”¨â€
> ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ–¹æ³•å¼•ç”¨æ˜¯lambdaè¡¨è¾¾å¼çš„å¦å¤–ä¸€ç§è¡¨ç°å½¢å¼å¹¶ä¸”å…¶è¯­æ³•æ¯”lambdaè¡¨è¾¾å¼æ›´åŠ ç®€å•

(a) æ–¹æ³•å¼•ç”¨
ä¸‰ç§è¡¨ç°å½¢å¼ï¼š

1.  å¯¹è±¡ï¼šï¼šå®ä¾‹æ–¹æ³•å
2.  ç±»ï¼šï¼šé™æ€æ–¹æ³•å
3.  ç±»ï¼šï¼šå®ä¾‹æ–¹æ³•å ï¼ˆlambdaå‚æ•°åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„è°ƒç”¨ è€…ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„å‚æ•°æ—¶å¯ç”¨ï¼‰

```java
 public void test() {
        /**
        *æ³¨æ„ï¼š
        *   1.lambdaä½“ä¸­è°ƒç”¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸è¿”å›å€¼ç±»å‹ï¼Œè¦ä¸å‡½æ•°å¼æ¥å£ä¸­æŠ½è±¡æ–¹æ³•çš„å‡½æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¿æŒä¸€è‡´ï¼
        *   2.è‹¥lambdaå‚æ•°åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„è°ƒç”¨è€…ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„å‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ClassName::method
        *
        */
        Consumer<Integer> con = (x) -> System.out.println(x);
        con.accept(100);

        // æ–¹æ³•å¼•ç”¨-å¯¹è±¡::å®ä¾‹æ–¹æ³•
        Consumer<Integer> con2 = System.out::println;
        con2.accept(200);

        // æ–¹æ³•å¼•ç”¨-ç±»å::é™æ€æ–¹æ³•å
        BiFunction<Integer, Integer, Integer> biFun = (x, y) -> Integer.compare(x, y);
        BiFunction<Integer, Integer, Integer> biFun2 = Integer::compare;
        Integer result = biFun2.apply(100, 200);

        // æ–¹æ³•å¼•ç”¨-ç±»å::å®ä¾‹æ–¹æ³•å
        BiFunction<String, String, Boolean> fun1 = (str1, str2) -> str1.equals(str2);
        BiFunction<String, String, Boolean> fun2 = String::equals;
        Boolean result2 = fun2.apply("hello", "world");
        System.out.println(result2);
    }
```

(b)æ„é€ å™¨å¼•ç”¨
æ ¼å¼ï¼šClassName::new

```java
public void test2() {

        // æ„é€ æ–¹æ³•å¼•ç”¨  ç±»å::new
        Supplier<Employee> sup = () -> new Employee();
        System.out.println(sup.get());
        Supplier<Employee> sup2 = Employee::new;
        System.out.println(sup2.get());

        // æ„é€ æ–¹æ³•å¼•ç”¨ ç±»å::new ï¼ˆå¸¦ä¸€ä¸ªå‚æ•°ï¼‰
        Function<Integer, Employee> fun = (x) -> new Employee(x);
        Function<Integer, Employee> fun2 = Employee::new;
        System.out.println(fun2.apply(100));
 }
```

(c)æ•°ç»„å¼•ç”¨

æ ¼å¼ï¼šType[]::new

```java
public void test(){
        // æ•°ç»„å¼•ç”¨
        Function<Integer, String[]> fun = (x) -> new String[x];
        Function<Integer, String[]> fun2 = String[]::new;
        String[] strArray = fun2.apply(10);
        Arrays.stream(strArray).forEach(System.out::println);
}
```

## Stream [API](https://so.csdn.net/so/search?q=API&spm=1001.2101.3001.7020)

Streamæ“ä½œçš„ä¸‰ä¸ªæ­¥éª¤

- åˆ›å»ºstream
- ä¸­é—´æ“ä½œï¼ˆè¿‡æ»¤ã€mapï¼‰
- ç»ˆæ­¢æ“ä½œ

streamçš„åˆ›å»ºï¼š

```java
    // 1ï¼Œæ ¡éªŒé€šè¿‡Collection ç³»åˆ—é›†åˆæä¾›çš„stream()æˆ–è€…paralleStream()
    List<String> list = new ArrayList<>();
    Strean<String> stream1 = list.stream();

    // 2.é€šè¿‡Arraysçš„é™æ€æ–¹æ³•stream()è·å–æ•°ç»„æµ
    String[] str = new String[10];
    Stream<String> stream2 = Arrays.stream(str);

    // 3.é€šè¿‡Streamç±»ä¸­çš„é™æ€æ–¹æ³•of
    Stream<String> stream3 = Stream.of("aa","bb","cc");

    // 4.åˆ›å»ºæ— é™æµ
    // è¿­ä»£
    Stream<Integer> stream4 = Stream.iterate(0,(x) -> x+2);

    //ç”Ÿæˆ
    Stream.generate(() ->Math.random());
```

Streamçš„ä¸­é—´æ“ä½œ:

```java
/**
   * ç­›é€‰ è¿‡æ»¤  å»é‡
   */
  emps.stream()
          .filter(e -> e.getAge() > 10)
          .limit(4)
          .skip(4)
          // éœ€è¦æµä¸­çš„å…ƒç´ é‡å†™hashCodeå’Œequalsæ–¹æ³•
          .distinct()
          .forEach(System.out::println);


  /**
   *  ç”Ÿæˆæ–°çš„æµ é€šè¿‡mapæ˜ å°„
   */
  emps.stream()
          .map((e) -> e.getAge())
          .forEach(System.out::println);


  /**
   *  è‡ªç„¶æ’åº  å®šåˆ¶æ’åº
   */
  emps.stream()
          .sorted((e1 ,e2) -> {
              if (e1.getAge().equals(e2.getAge())){
                  return e1.getName().compareTo(e2.getName());
              } else{
                  return e1.getAge().compareTo(e2.getAge());
              }
          })
          .forEach(System.out::println);
```

Streamçš„ç»ˆæ­¢æ“ä½œï¼š

```java
 /**
         *      æŸ¥æ‰¾å’ŒåŒ¹é…
         *          allMatch-æ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ 
         *          anyMatch-æ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ 
         *          noneMatch-æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…æ‰€æœ‰å…ƒç´ 
         *          findFirst-è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ 
         *          findAny-è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ 
         *          count-è¿”å›æµä¸­å…ƒç´ çš„æ€»ä¸ªæ•°
         *          max-è¿”å›æµä¸­æœ€å¤§å€¼
         *          min-è¿”å›æµä¸­æœ€å°å€¼
         */

        /**
         *  æ£€æŸ¥æ˜¯å¦åŒ¹é…å…ƒç´ 
         */
        boolean b1 = emps.stream()
                .allMatch((e) -> e.getStatus().equals(Employee.Status.BUSY));
        System.out.println(b1);

        boolean b2 = emps.stream()
                .anyMatch((e) -> e.getStatus().equals(Employee.Status.BUSY));
        System.out.println(b2);

        boolean b3 = emps.stream()
                .noneMatch((e) -> e.getStatus().equals(Employee.Status.BUSY));
        System.out.println(b3);

        Optional<Employee> opt = emps.stream()
                .findFirst();
        System.out.println(opt.get());

        // å¹¶è¡Œæµ
        Optional<Employee> opt2 = emps.parallelStream()
                .findAny();
        System.out.println(opt2.get());

        long count = emps.stream()
                .count();
        System.out.println(count);

        Optional<Employee> max = emps.stream()
                .max((e1, e2) -> Double.compare(e1.getSalary(), e2.getSalary()));
        System.out.println(max.get());

        Optional<Employee> min = emps.stream()
                .min((e1, e2) -> Double.compare(e1.getSalary(), e2.getSalary()));
        System.out.println(min.get());
```

è¿˜æœ‰åŠŸèƒ½æ¯”è¾ƒå¼ºå¤§çš„ä¸¤ä¸ªç»ˆæ­¢æ“ä½œ reduceå’Œcollect
reduceæ“ä½œï¼š reduce:(T identity,BinaryOperator)/reduce(BinaryOperator)-å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼

```java
         /**
         *  reduce ï¼šè§„çº¦æ“ä½œ
         */
        List<Integer> list = Arrays.asList(1,2,3,4,5,6,7,8,9,10);
        Integer count2 = list.stream()
                .reduce(0, (x, y) -> x + y);
        System.out.println(count2);

        Optional<Double> sum = emps.stream()
                .map(Employee::getSalary)
                .reduce(Double::sum);
        System.out.println(sum);

```

collectæ“ä½œï¼šCollect-å°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ï¼Œæ¥æ”¶ä¸€ä¸ªCollectionæ¥å£çš„å®ç°ï¼Œç”¨äºç»™Streamä¸­å…ƒç´ åšæ±‡æ€»çš„æ–¹æ³•

```java
        /**
         *  collectï¼šæ”¶é›†æ“ä½œ
         */

        List<Integer> ageList = emps.stream()
                .map(Employee::getAge)
                .collect(Collectors.toList());
        ageList.stream().forEach(System.out::println);
```

## å¹¶è¡Œæµå’Œä¸²è¡Œæµ

åœ¨jdk1.8æ–°çš„streamåŒ…ä¸­é’ˆå¯¹é›†åˆçš„æ“ä½œä¹Ÿæä¾›äº†å¹¶è¡Œæ“ä½œæµå’Œä¸²è¡Œæ“ä½œæµã€‚å¹¶è¡Œæµå°±æ˜¯æŠŠå†…å®¹åˆ‡å‰²æˆå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ä¸”ä½¿ç”¨å¤šä¸ªçº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„å†…å®¹ã€‚Stream apiä¸­å£°æ˜å¯ä»¥é€šè¿‡parallel()ä¸sequential()æ–¹æ³•åœ¨å¹¶è¡Œæµå’Œä¸²è¡Œæµä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚
jdk1.8å¹¶è¡Œæµä½¿ç”¨çš„æ˜¯fork/joinæ¡†æ¶è¿›è¡Œå¹¶è¡Œæ“ä½œ

### ForkJoinæ¡†æ¶

Fork/Join æ¡†æ¶ï¼šå°±æ˜¯åœ¨å¿…è¦çš„æƒ…å†µä¸‹ï¼Œå°†ä¸€ä¸ªå¤§ä»»åŠ¡ï¼Œè¿›è¡Œæ‹†åˆ†(fork)æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼ˆæ‹†åˆ°ä¸å¯å†æ‹†æ—¶ï¼‰ï¼Œå†å°†ä¸€ä¸ªä¸ªçš„å°ä»»åŠ¡è¿ç®—çš„ç»“æœè¿›è¡Œ join æ±‡æ€»ã€‚
å…³é”®å­—ï¼šé€’å½’åˆ†åˆã€åˆ†è€Œæ²»ä¹‹ã€‚
é‡‡ç”¨ â€œå·¥ä½œçªƒå–â€æ¨¡å¼ï¼ˆwork-stealingï¼‰ï¼š
å½“æ‰§è¡Œæ–°çš„ä»»åŠ¡æ—¶å®ƒå¯ä»¥å°†å…¶æ‹†åˆ†åˆ†æˆæ›´å°çš„ä»»åŠ¡æ‰§è¡Œï¼Œå¹¶å°†å°ä»»åŠ¡åŠ åˆ°çº¿
ç¨‹é˜Ÿåˆ—ä¸­ï¼Œç„¶åå†ä»ä¸€ä¸ªéšæœºçº¿ç¨‹çš„é˜Ÿåˆ—ä¸­å·ä¸€ä¸ªå¹¶æŠŠå®ƒæ”¾åœ¨è‡ªå·±çš„é˜Ÿåˆ—ä¸­
ç›¸å¯¹äºä¸€èˆ¬çš„çº¿ç¨‹æ± å®ç°,fork/joinæ¡†æ¶çš„ä¼˜åŠ¿ä½“ç°åœ¨å¯¹å…¶ä¸­åŒ…å«çš„ä»»åŠ¡çš„
å¤„ç†æ–¹å¼ä¸Š.åœ¨ä¸€èˆ¬çš„çº¿ç¨‹æ± ä¸­,å¦‚æœä¸€ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ç”±äºæŸäº›åŸå› 
æ— æ³•ç»§ç»­è¿è¡Œ,é‚£ä¹ˆè¯¥çº¿ç¨‹ä¼šå¤„äºç­‰å¾…çŠ¶æ€.è€Œåœ¨fork/joinæ¡†æ¶å®ç°ä¸­,å¦‚æœ
æŸä¸ªå­é—®é¢˜ç”±äºç­‰å¾…å¦å¤–ä¸€ä¸ªå­é—®é¢˜çš„å®Œæˆè€Œæ— æ³•ç»§ç»­è¿è¡Œ.é‚£ä¹ˆå¤„ç†è¯¥å­
é—®é¢˜çš„çº¿ç¨‹ä¼šä¸»åŠ¨å¯»æ‰¾å…¶ä»–å°šæœªè¿è¡Œçš„å­é—®é¢˜æ¥æ‰§è¡Œ.è¿™ç§æ–¹å¼å‡å°‘äº†çº¿ç¨‹
çš„ç­‰å¾…æ—¶é—´,æé«˜äº†æ€§èƒ½.ã€‚

```java
/**
 * è¦æƒ³ä½¿ç”¨Farkâ€”Joinï¼Œç±»å¿…é¡»ç»§æ‰¿
 * RecursiveActionï¼ˆæ— è¿”å›å€¼ï¼‰
 * Or
 * RecursiveTaskï¼ˆæœ‰è¿”å›å€¼ï¼‰
*
*/
public class ForkJoin extends RecursiveTask<Long> {

    /**
     * è¦æƒ³ä½¿ç”¨Farkâ€”Joinï¼Œç±»å¿…é¡»ç»§æ‰¿RecursiveActionï¼ˆæ— è¿”å›å€¼ï¼‰ æˆ–è€…
     * RecursiveTaskï¼ˆæœ‰è¿”å›å€¼ï¼‰
     *
     * @author Wuyouxin
     */
    private static final long serialVersionUID = 23423422L;

    private long start;
    private long end;

    public ForkJoin() {
    }

    public ForkJoin(long start, long end) {
        this.start = start;
        this.end = end;
    }

    // å®šä¹‰é˜™å€¼
    private static final long THRESHOLD = 10000L;

    @Override
    protected Long compute() {
        if (end - start <= THRESHOLD) {
            long sum = 0;
            for (long i = start; i < end; i++) {
                sum += i;
            }
            return sum;
        } else {
            long middle = (end - start) / 2;
            ForkJoin left = new ForkJoin(start, middle);
            //æ‹†åˆ†å­ä»»åŠ¡ï¼Œå‹å…¥çº¿ç¨‹é˜Ÿåˆ—
            left.fork();
            ForkJoin right = new ForkJoin(middle + 1, end);
            right.fork();

            //åˆå¹¶å¹¶è¿”å›
            return left.join() + right.join();
        }
    }

    /**
     * å®ç°æ•°çš„ç´¯åŠ 
     */
    @Test
    public void test1() {
        //å¼€å§‹æ—¶é—´
        Instant start = Instant.now();

        //è¿™é‡Œéœ€è¦ä¸€ä¸ªçº¿ç¨‹æ± çš„æ”¯æŒ
        ForkJoinPool pool = new ForkJoinPool();

        ForkJoinTask<Long> task = new ForkJoin(0L, 10000000000L);
        // æ²¡æœ‰è¿”å›å€¼     pool.execute();
        // æœ‰è¿”å›å€¼
        long sum = pool.invoke(task);

        //ç»“æŸæ—¶é—´
        Instant end = Instant.now();
        System.out.println(Duration.between(start, end).getSeconds());
    }

    /**
     * java8 å¹¶è¡Œæµ parallel()
     */
    @Test
    public void test2() {
        //å¼€å§‹æ—¶é—´
        Instant start = Instant.now();

        // å¹¶è¡Œæµè®¡ç®—    ç´¯åŠ æ±‚å’Œ
        LongStream.rangeClosed(0, 10000000000L).parallel()
                .reduce(0, Long :: sum);

        //ç»“æŸæ—¶é—´
        Instant end = Instant.now();
        System.out.println(Duration.between(start, end).getSeconds());
    }

    @Test
    public void test3(){
        List<Integer> list = Arrays.asList(1, 2, 3, 4, 5);
        list.stream().forEach(System.out::print);

        list.parallelStream()
            .forEach(System.out::print);
    }
```

å±•ç¤ºå¤šçº¿ç¨‹çš„æ•ˆæœï¼š

```java
@Test
    public void test(){
        // å¹¶è¡Œæµ å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ
        List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9);
        numbers.parallelStream()
                .forEach(System.out::print);

        //
        System.out.println("=========================");
        numbers.stream()
                     .sequential()
                     .forEach(System.out::print);
    }
```

## Optionalå®¹å™¨

```java
ä½¿ç”¨Optionalå®¹å™¨å¯ä»¥å¿«é€Ÿçš„å®šä½NPEï¼Œå¹¶ä¸”åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥å‡å°‘å¯¹å‚æ•°éç©ºæ£€éªŒçš„ä»£ç é‡ã€‚
1
/**
     *      Optional.of(T t); // åˆ›å»ºä¸€ä¸ªOptionalå®ä¾‹
     *      Optional.empty(); // åˆ›å»ºä¸€ä¸ªç©ºçš„Optionalå®ä¾‹
     *      Optional.ofNullable(T t); // è‹¥Tä¸ä¸ºnullï¼Œåˆ›å»ºä¸€ä¸ªOptionalå®ä¾‹ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªç©ºå®ä¾‹
     *      isPresent();    // åˆ¤æ–­æ˜¯å¤ŸåŒ…å«å€¼
     *      orElse(T t);   //å¦‚æœè°ƒç”¨å¯¹è±¡åŒ…å«å€¼ï¼Œè¿”å›è¯¥å€¼ï¼Œå¦åˆ™è¿”å›T
     *      orElseGet(Supplier s);  // å¦‚æœè°ƒç”¨å¯¹è±¡åŒ…å«å€¼ï¼Œè¿”å›è¯¥å€¼ï¼Œå¦åˆ™è¿”å›sä¸­è·å–çš„å€¼
     *      map(Function f): // å¦‚æœæœ‰å€¼å¯¹å…¶å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†åçš„Optionalï¼Œå¦åˆ™è¿”å›Optional.empty();
     *      flatMap(Function mapper);// ä¸mapç±»ä¼¼ã€‚è¿”å›å€¼æ˜¯Optional
     *
     *      æ€»ç»“ï¼šOptional.of(null)  ä¼šç›´æ¥æŠ¥NPE
     */

Optional<Employee> op = Optional.of(new Employee("zhansan", 11, 12.32, Employee.Status.BUSY));
        System.out.println(op.get());

        // NPE
        Optional<Employee> op2 = Optional.of(null);
        System.out.println(op2);
@Test
    public void test2(){
        Optional<Object> op = Optional.empty();
        System.out.println(op);

        // No value present
        System.out.println(op.get());
    }
@Test
    public void test3(){
        Optional<Employee> op = Optional.ofNullable(new Employee("lisi", 33, 131.42, Employee.Status.FREE));
        System.out.println(op.get());

        Optional<Object> op2 = Optional.ofNullable(null);
        System.out.println(op2);
       // System.out.println(op2.get());
    }
    @Test
    public void test5(){
        Optional<Employee> op1 = Optional.ofNullable(new Employee("å¼ ä¸‰", 11, 11.33, Employee.Status.VOCATION));
        System.out.println(op1.orElse(new Employee()));
        System.out.println(op1.orElse(null));
    }

    @Test
    public void test6(){
        Optional<Employee> op1 = Optional.of(new Employee("ç”°ä¸ƒ", 11, 12.31, Employee.Status.BUSY));
        op1 = Optional.empty();
        Employee employee = op1.orElseGet(() -> new Employee());
        System.out.println(employee);
    }

    @Test
    public void test7(){
        Optional<Employee> op1 = Optional.of(new Employee("ç”°ä¸ƒ", 11, 12.31, Employee.Status.BUSY));
        System.out.println(op1.map( (e) -> e.getSalary()).get());
    }
```

### æ¥å£ä¸­å¯ä»¥å®šä¹‰é»˜è®¤å®ç°æ–¹æ³•å’Œé™æ€æ–¹æ³•

åœ¨æ¥å£ä¸­å¯ä»¥ä½¿ç”¨defaultå’Œstaticå…³é”®å­—æ¥ä¿®é¥°æ¥å£ä¸­å®šä¹‰çš„æ™®é€šæ–¹æ³•

```java
public interface Interface {
    default  String getName(){
        return "zhangsan";
    }

    static String getName2(){
        return "zhangsan";
    }
}

```

åœ¨JDK1.8ä¸­å¾ˆå¤šæ¥å£ä¼šæ–°å¢æ–¹æ³•ï¼Œä¸ºäº†ä¿è¯1.8å‘ä¸‹å…¼å®¹ï¼Œ1.7ç‰ˆæœ¬ä¸­çš„æ¥å£å®ç°ç±»ä¸ç”¨æ¯ä¸ªéƒ½é‡æ–°å®ç°æ–°æ·»åŠ çš„æ¥å£æ–¹æ³•ï¼Œå¼•å…¥äº†defaulté»˜è®¤å®ç°ï¼Œstaticçš„ç”¨æ³•æ˜¯ç›´æ¥ç”¨æ¥å£åå»è°ƒæ–¹æ³•å³å¯ã€‚å½“ä¸€ä¸ªç±»ç»§æ‰¿çˆ¶ç±»åˆå®ç°æ¥å£æ—¶ï¼Œè‹¥åä¸¤è€…æ–¹æ³•åç›¸åŒï¼Œåˆ™ä¼˜å…ˆç»§æ‰¿çˆ¶ç±»ä¸­çš„åŒåæ–¹æ³•ï¼Œå³â€œç±»ä¼˜å…ˆâ€ï¼Œå¦‚æœå®ç°ä¸¤ä¸ªåŒåæ–¹æ³•çš„æ¥å£ï¼Œåˆ™è¦æ±‚å®ç°ç±»å¿…é¡»æ‰‹åŠ¨å£°æ˜é»˜è®¤å®ç°å“ªä¸ªæ¥å£ä¸­çš„æ–¹æ³•ã€‚

### æ–°çš„æ—¥æœŸAPI LocalDate | LocalTime | LocalDateTime

æ–°çš„æ—¥æœŸAPIéƒ½æ˜¯ä¸å¯å˜çš„ï¼Œæ›´ä½¿ç”¨äºå¤šçº¿ç¨‹çš„ä½¿ç”¨ç¯å¢ƒä¸­

```java
    @Test
    public void test(){
        // ä»é»˜è®¤æ—¶åŒºçš„ç³»ç»Ÿæ—¶é’Ÿè·å–å½“å‰çš„æ—¥æœŸæ—¶é—´ã€‚ä¸ç”¨è€ƒè™‘æ—¶åŒºå·®
        LocalDateTime date = LocalDateTime.now();
        //2018-07-15T14:22:39.759
        System.out.println(date);

        System.out.println(date.getYear());
        System.out.println(date.getMonthValue());
        System.out.println(date.getDayOfMonth());
        System.out.println(date.getHour());
        System.out.println(date.getMinute());
        System.out.println(date.getSecond());
        System.out.println(date.getNano());

        // æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªLocalDateTimeå®ä¾‹
        LocalDateTime date2 = LocalDateTime.of(2017, 12, 17, 9, 31, 31, 31);
        System.out.println(date2);
        // è¿›è¡ŒåŠ æ“ä½œï¼Œå¾—åˆ°æ–°çš„æ—¥æœŸå®ä¾‹
        LocalDateTime date3 = date2.plusDays(12);
        System.out.println(date3);
        // è¿›è¡Œå‡æ“ä½œï¼Œå¾—åˆ°æ–°çš„æ—¥æœŸå®ä¾‹
        LocalDateTime date4 = date3.minusYears(2);
        System.out.println(date4);
    }

    @Test
    public void test2(){
        // æ—¶é—´æˆ³  1970å¹´1æœˆ1æ—¥00ï¼š00ï¼š00 åˆ°æŸä¸€ä¸ªæ—¶é—´ç‚¹çš„æ¯«ç§’å€¼
        // é»˜è®¤è·å–UTCæ—¶åŒº
        Instant ins = Instant.now();
        System.out.println(ins);

        System.out.println(LocalDateTime.now().toInstant(ZoneOffset.of("+8")).toEpochMilli());
        System.out.println(System.currentTimeMillis());

        System.out.println(Instant.now().toEpochMilli());
        System.out.println(Instant.now().atOffset(ZoneOffset.ofHours(8)).toInstant().toEpochMilli());
    }
    @Test
    public void test3(){
        // Duration:è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”
        // Periodï¼šè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”

        Instant ins1 = Instant.now();

        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        Instant ins2 = Instant.now();
        Duration dura = Duration.between(ins1, ins2);
        System.out.println(dura);
        System.out.println(dura.toMillis());

        System.out.println("======================");
        LocalTime localTime = LocalTime.now();
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        LocalTime localTime2 = LocalTime.now();
        Duration du2 = Duration.between(localTime, localTime2);
        System.out.println(du2);
        System.out.println(du2.toMillis());
    }
@Test
    public void test4(){
        LocalDate localDate =LocalDate.now();

        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        LocalDate localDate2 = LocalDate.of(2016,12,12);
        Period pe = Period.between(localDate, localDate2);
        System.out.println(pe);
    }
    @Test
    public void test5(){
        // temperalAdjust æ—¶é—´æ ¡éªŒå™¨
        // ä¾‹å¦‚è·å–ä¸‹å‘¨æ—¥  ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥
        LocalDateTime ldt1 = LocalDateTime.now();
        System.out.println(ldt1);

        // è·å–ä¸€å¹´ä¸­çš„ç¬¬ä¸€å¤©
        LocalDateTime ldt2 = ldt1.withDayOfYear(1);
        System.out.println(ldt2);
        // è·å–ä¸€ä¸ªæœˆä¸­çš„ç¬¬ä¸€å¤©
        LocalDateTime ldt3 = ldt1.withDayOfMonth(1);
        System.out.println(ldt3);

        LocalDateTime ldt4 = ldt1.with(TemporalAdjusters.next(DayOfWeek.FRIDAY));
        System.out.println(ldt4);

        // è·å–ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥
        LocalDateTime ldt5 = ldt1.with((t) -> {
            LocalDateTime ldt6 = (LocalDateTime)t;
            DayOfWeek dayOfWeek = ldt6.getDayOfWeek();
            if (DayOfWeek.FRIDAY.equals(dayOfWeek)){
                return ldt6.plusDays(3);
            }
            else if (DayOfWeek.SATURDAY.equals(dayOfWeek)){
                return ldt6.plusDays(2);
            }
            else {
                return ldt6.plusDays(1);
            }
        });
        System.out.println(ldt5);
    }
    @Test
    public void test6(){
        // DateTimeFormatter: æ ¼å¼åŒ–æ—¶é—´/æ—¥æœŸ
        // è‡ªå®šä¹‰æ ¼å¼
        LocalDateTime ldt = LocalDateTime.now();
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyyå¹´MMæœˆddæ—¥");
        String strDate1 = ldt.format(formatter);
        String strDate = formatter.format(ldt);
        System.out.println(strDate);
        System.out.println(strDate1);

        // ä½¿ç”¨apiæä¾›çš„æ ¼å¼
        DateTimeFormatter dtf = DateTimeFormatter.ISO_DATE;
        LocalDateTime ldt2 = LocalDateTime.now();
        String strDate3 = dtf.format(ldt2);
        System.out.println(strDate3);

        // è§£æå­—ç¬¦ä¸²toæ—¶é—´
        DateTimeFormatter df = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");
        LocalDateTime time = LocalDateTime.now();
        String localTime = df.format(time);
        LocalDateTime ldt4 = LocalDateTime.parse("2017-09-28 17:07:05",df);
        System.out.println("LocalDateTimeè½¬æˆStringç±»å‹çš„æ—¶é—´ï¼š"+localTime);
        System.out.println("Stringç±»å‹çš„æ—¶é—´è½¬æˆLocalDateTimeï¼š"+ldt4);
    }
    // ZoneTime  ZoneDate       ZoneDateTime
    @Test
    public void test7(){
        LocalDateTime now = LocalDateTime.now(ZoneId.of("Asia/Shanghai"));
        System.out.println(now);

        LocalDateTime now2 = LocalDateTime.now();
        ZonedDateTime zdt = now2.atZone(ZoneId.of("Asia/Shanghai"));
        System.out.println(zdt);

        Set<String> set = ZoneId.getAvailableZoneIds();
        set.stream().forEach(System.out::println);
    }
```

è¡¥å……ï¼š

> è¡¨ç¤ºæ—¥æœŸçš„LocalDate
> è¡¨ç¤ºæ—¶é—´çš„LocalTime
> è¡¨ç¤ºæ—¥æœŸæ—¶é—´çš„LocalDateTime

æ–°çš„æ—¥æœŸAPIçš„å‡ ä¸ªä¼˜ç‚¹ï¼š

```java
 * ä¹‹å‰ä½¿ç”¨çš„java.util.Dateæœˆä»½ä»0å¼€å§‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼š+1ä½¿ç”¨ï¼Œå¾ˆä¸æ–¹ä¾¿ï¼Œjava.time.LocalDateæœˆä»½å’Œæ˜ŸæœŸéƒ½æ”¹æˆäº†enum
 * java.util.Dateå’ŒSimpleDateFormatéƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€ŒLocalDateå’ŒLocalTimeå’Œæœ€åŸºæœ¬çš„Stringä¸€æ ·ï¼Œæ˜¯ä¸å˜ç±»å‹ï¼Œä¸ä½†çº¿ç¨‹å®‰å…¨ï¼Œè€Œä¸”ä¸èƒ½ä¿®æ”¹ã€‚
 * java.util.Dateæ˜¯ä¸€ä¸ªâ€œä¸‡èƒ½æ¥å£â€ï¼Œå®ƒåŒ…å«æ—¥æœŸã€æ—¶é—´ï¼Œè¿˜æœ‰æ¯«ç§’æ•°ï¼Œæ›´åŠ æ˜ç¡®éœ€æ±‚å–èˆ
 * æ–°æ¥å£æ›´å¥½ç”¨çš„åŸå› æ˜¯è€ƒè™‘åˆ°äº†æ—¥æœŸæ—¶é—´çš„æ“ä½œï¼Œç»å¸¸å‘ç”Ÿå¾€å‰æ¨æˆ–å¾€åæ¨å‡ å¤©çš„æƒ…å†µã€‚ç”¨java.util.Dateé…åˆCalendarè¦å†™å¥½å¤šä»£ç ï¼Œè€Œä¸”ä¸€èˆ¬çš„å¼€å‘äººå‘˜è¿˜ä¸ä¸€å®šèƒ½å†™å¯¹ã€‚

```

- LocalDate

```java
public static void localDateTest() {

        //è·å–å½“å‰æ—¥æœŸ,åªå«å¹´æœˆæ—¥ å›ºå®šæ ¼å¼ yyyy-MM-dd    2018-05-04
        LocalDate today = LocalDate.now();

        // æ ¹æ®å¹´æœˆæ—¥å–æ—¥æœŸï¼Œ5æœˆå°±æ˜¯5ï¼Œ
        LocalDate oldDate = LocalDate.of(2018, 5, 1);

        // æ ¹æ®å­—ç¬¦ä¸²å–ï¼šé»˜è®¤æ ¼å¼yyyy-MM-ddï¼Œ02ä¸èƒ½å†™æˆ2
        LocalDate yesteday = LocalDate.parse("2018-05-03");

        // å¦‚æœä¸æ˜¯é—°å¹´ ä¼ å…¥29å·ä¹Ÿä¼šæŠ¥é”™
        LocalDate.parse("2018-02-29");
    }
```

- LocalDateå¸¸ç”¨è½¬åŒ–

```java
    /**
     * æ—¥æœŸè½¬æ¢å¸¸ç”¨,ç¬¬ä¸€å¤©æˆ–è€…æœ€åä¸€å¤©...
     */
    public static void localDateTransferTest(){
        //2018-05-04
        LocalDate today = LocalDate.now();
        // å–æœ¬æœˆç¬¬1å¤©ï¼š 2018-05-01
        LocalDate firstDayOfThisMonth = today.with(TemporalAdjusters.firstDayOfMonth());
        // å–æœ¬æœˆç¬¬2å¤©ï¼š2018-05-02
        LocalDate secondDayOfThisMonth = today.withDayOfMonth(2);
        // å–æœ¬æœˆæœ€åä¸€å¤©ï¼Œå†ä¹Ÿä¸ç”¨è®¡ç®—æ˜¯28ï¼Œ29ï¼Œ30è¿˜æ˜¯31ï¼š 2018-05-31
        LocalDate lastDayOfThisMonth = today.with(TemporalAdjusters.lastDayOfMonth());
        // å–ä¸‹ä¸€å¤©ï¼š2018-06-01
        LocalDate firstDayOf2015 = lastDayOfThisMonth.plusDays(1);
        // å–2018å¹´10æœˆç¬¬ä¸€ä¸ªå‘¨ä¸‰ so easy?ï¼š  2018-10-03
        LocalDate thirdMondayOf2018 = LocalDate.parse("2018-10-01").with(TemporalAdjusters.firstInMonth(DayOfWeek.WEDNESDAY));
    }
```

- LocalTime

```java
 public static void localTimeTest(){
        //16:25:46.448(çº³ç§’å€¼)
        LocalTime todayTimeWithMillisTime = LocalTime.now();
        //16:28:48 ä¸å¸¦çº³ç§’å€¼
        LocalTime todayTimeWithNoMillisTime = LocalTime.now().withNano(0);
        LocalTime time1 = LocalTime.parse("23:59:59");
    }
```

- LocalDateTime

```java
public static void localDateTimeTest(){
        //è½¬åŒ–ä¸ºæ—¶é—´æˆ³  æ¯«ç§’å€¼
        long time1 = LocalDateTime.now().toInstant(ZoneOffset.of("+8")).toEpochMilli();
        long time2 = System.currentTimeMillis();

        //æ—¶é—´æˆ³è½¬åŒ–ä¸ºlocaldatetime
        DateTimeFormatter df= DateTimeFormatter.ofPattern("YYYY-MM-dd HH:mm:ss.SSS");

        System.out.println(df.format(LocalDateTime.ofInstant(Instant.ofEpochMilli(time1),ZoneId.of("Asia/Shanghai"))));
    }
```

*è·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚*ğŸš€